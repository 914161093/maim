import{s as e,g as t,r as o,a,x as n,o as s,c as l,w as d,h as c,i,f as h,j as p,y as r,z as u,v as g,q as m,u as f,I as _,t as x,A as k}from"./index-0b98c233.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";const w=""+new URL("login_bg-29094466.png",import.meta.url).href;const b=C({data:()=>({phone:"",pwd:"",second:60,interval:null,showText:!0,code:"",isCode:!1}),onShow(){const n=window.location.href,s=/[?&]channel(?:=([^&#]*)|&|#|$)/.exec(n),l=s&&s[1]?decodeURIComponent(s[1].replace(/\+/g," ")):null;e("channel",l),""==t("token")?async function(){try{var t=await o({url:"https://api.maimangbox.cn/getToken",header:{"content-type":"application/json"},data:{platform:3,channel:l},method:"POST"});1e4==t.data.resultCode?(console.log("10000"),e("token",t.data.data),o({url:"https://api.maimangbox.cn/login/page",data:{},header:{"content-type":"application/json","api-token":t.data.data},method:"POST",success:e=>{console.log(e),2==e.data.data.isCode&&(this.isCode=!0)}})):(console.log(t),e("token",""),c(),a({title:t.data.resultMsg,icon:"none"}))}catch(n){console.error(n)}}():o({url:"https://api.maimangbox.cn/login/page",data:{},header:{"content-type":"application/json","api-token":t("token")},method:"POST",success:e=>{console.log(e),2==e.data.data.isCode&&(this.isCode=!0)}})},methods:{startCountdown(){let e=this;e.interval=setInterval((()=>{this.second--,0===e.second&&(clearInterval(e.interval),this.showText=!0,this.second=60)}),1e3)},login(){const s=window.location.href,l=/[?&]next(?:=([^&#]*)|&|#|$)/.exec(s);l&&l[1]&&decodeURIComponent(l[1].replace(/\+/g," "));this.phone?/^[1][3,4,5,7,8,9][0-9]{9}$/.test(this.phone)?this.isCode&&""==this.code?a({title:"请输入验证码",icon:"none"}):o({url:"https://api.maimangbox.cn/login",data:{phone:this.phone,code:this.code,next:"login"},header:{"content-type":"application/json","api-token":t("token")},method:"POST",success:o=>{1e4==o.data.resultCode&&(a({title:"登录成功！",icon:"none"}),console.log(o.data.data),e("token",o.data.data),console.log(t("token")),n())}}):a({title:"请输入正确手机号",icon:"none"}):a({title:"请输入您的手机号",icon:"none"})},getCode(){this.phone?/^[1][3,4,5,7,8,9][0-9]{9}$/.test(this.phone)?(t("token"),o({url:"https://api.maimangbox.cn/sendMsg",data:{phone:this.phone},header:{"content-type":"application/json","api-token":t("token")},method:"POST",success:e=>{a({title:e.data.resultMsg,icon:"none"}),1e4==e.data.resultCode&&(this.showText=!1,this.startCountdown())}})):a({title:"请输入正确手机号",icon:"none"}):a({title:"请输入您的手机号",icon:"none"})}}},[["render",function(e,t,o,a,n,c){const C=m,b=i,y=f,v=_,T=x,j=k;return s(),l(b,{class:"container"},{default:d((()=>[h(b,{class:"img-a"},{default:d((()=>[h(b,{class:"t-b"},{default:d((()=>[h(C,{src:w,class:"logo",mode:"widthFix"}),h(b,null,{default:d((()=>[h(b,{class:"title"},{default:d((()=>[p("智能金融,管家服务")])),_:1}),h(b,{class:"subtitle"},{default:d((()=>[p("麦麦")])),_:1})])),_:1})])),_:1})])),_:1}),h(b,{class:"login-view",style:{}},{default:d((()=>[h(b,{class:"t-login"},{default:d((()=>[h(j,{class:"cl"},{default:d((()=>[h(b,{class:"t-a"},{default:d((()=>[h(y,{class:"txt"},{default:d((()=>[p("手机号")])),_:1}),h(v,{type:"number",name:"phone",placeholder:"请输入您的手机号",maxlength:"11",modelValue:n.phone,"onUpdate:modelValue":t[0]||(t[0]=e=>n.phone=e)},null,8,["modelValue"])])),_:1}),r(h(b,{class:"t-a"},{default:d((()=>[h(y,{class:"txt"},{default:d((()=>[p("验证码")])),_:1}),h(v,{type:"number",name:"code",maxlength:"18",placeholder:"请输入您的密码",modelValue:n.code,"onUpdate:modelValue":t[1]||(t[1]=e=>n.code=e)},null,8,["modelValue"]),n.showText?(s(),l(b,{key:0,class:"t-c",onClick:t[2]||(t[2]=e=>c.getCode())},{default:d((()=>[p("发送验证码")])),_:1})):(s(),l(b,{key:1,class:"t-c",style:{"background-color":"#A7A7A7"}},{default:d((()=>[p("重新发送("+g(n.second)+")",1)])),_:1}))])),_:1},512),[[u,n.isCode]]),h(T,{onClick:t[3]||(t[3]=e=>c.login()),class:"login_btn"},{default:d((()=>[p("登 录")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-b6571dbe"]]);export{b as default};
